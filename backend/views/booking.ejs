<%- include("partials/header") -%>
<%- include("partials/nav_bar") -%>

<style>
.fl-det{
    display: flex;
    background-color: rgba(255, 255, 252, 0.105);
    justify-content: center;
    box-shadow: 2px 5px 0 0 #002e7d;
}
.fl-det .len{
    margin: 20px;
}
</style>

<div class="book">
    <h2>General information</h2>
    <form action="/booking/createbooking" method="post">   

    <%if(userdetail.userRole == 'user'){%>
     
            
            <input name="Flight_ID" id="Flight_ID" value="<%=formData%>" hidden/>
            <div class="fl-det">
                <h3 class="len">Flight_ID : <%=formData%></h3>
                <h3 class="len">Origin :<%=flightInfo[0].origin%></h3>
                <h3 class="len">Destination: <%=flightInfo[0].destination%></h3>
            </div>
                
        
        <div >
            <label for="firstname">First Name</label>
                <input type="text" placeholder="First Name" name="firstname" id="firstname" value="<%=userdetail.user.first_name%>" required style="display: block"/>

            <label for="lastname">Last Name</label>
                <input type="text" placeholder="Last Name" name="lastname" id="lastname" value="<%=userdetail.user.last_name%>" required style="display: block"/>
            
            <label>Date of birth</label>
                <input type="datetime" name="dob" id="dob" value="<%=userdetail.user.dob%>" disabled style="display: block"/>
            <br>
            <label for="gender">Gender</label>
            <select name="gender" id="gender">
                <option value="<%=userdetail.user.gender%>"><%=userdetail.user.gender%></option>
            </select> 
        </div>
        <div>
            <label for="Passport_no">Passport Number</label>
                <input name="Passport_no" id="Passport_no" value="<%=userdetail.user.passport_no%>" required style="display: block"/>
        
            <label for="mobile">Mobile Number</label>
                <input type="tel" name="mobile" id="mobile" value="<%=userdetail.user.mobile%>" disabled style="display: block"/>

            <label for="email">Email</label>
                <input type="email" name="email" id="email" value="<%=userdetail.user.email%>" required style="display: block"/>
            
            <label for="custtype">Customer Type</label>
                <select name="custtype" id="custtype">
                    <option value="registered">Registered</option>
                </select> 
        </div>
    </div>
    <%}
    else{%>
            
        <input name="Flight_ID" id="Flight_ID" value="<%=formData%>" hidden/>
        <div class="fl-det">
            <h3 class="len">Flight_ID : <%=formData%></h3>
            <h3 class="len">Origin :<%=flightInfo[0].origin%></h3>
            <h3 class="len">Destination: <%=flightInfo[0].destination%></h3>
        </div>
        <div>
            <label for="firstname">First Name</label>
                <input type="text" placeholder="First Name" name="firstname" id="firstname" required style="display: block"/>

            <label for="lastname">Last Name</label>
                <input type="text" placeholder="Last Name" name="lastname" id="lastname" required style="display: block"/>
            
            <label>Date of birth</label>
                <input type="date" name="dob" id="dob" required style="display: block"/>
            <br>
            <label for="gender">Gender</label>
            <select name="gender" id="gender">
                <option selected disabled>--Choose one--</option>
                <option value="Male">Male</option>
                <option value="Female">Female</option>
                <option value="Other">Other</option>
            </select> 
        </div>
        <div>
            <label for="Passport_no">Passport Number</label>
                <input name="Passport_no" id="Passport_no" required style="display: block"/>
        
            <label for="mobile">Mobile Number</label>
                <input type="tel" name="mobile" id="mobile" required style="display: block"/>

            <label for="email">Email</label>
                <input type="email" name="email" id="email" required style="display: block"/>
            
            <label for="custtype">Customer Type</label>
                <select name="custtype" id="custtype">
                    <option value="guest">Guest</option>
                </select> 
        </div>
    <%}%>




<div>
    <label for="passengers">No of Passengers</label>
    <select for="passengers" class="select-bar" id="passengers" required>
      <option value="Select" selected disabled>- Select -</option>
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5</option>
      <option value="6">6</option>
    </select>
    <button type="button" name="Add Passenger Details" class="passdetatil" onclick="button(); this.disabled= true;">Add Passenger Details</button> 
  </div>
  
  <!-- include a script tag that loads your JavaScript file -->
  <script src="path/to/your/script.js" type="text/javascript"></script>
  
  <script type="text/javascript">

    // add a "click" event listener to the button
    function button(){
      // get the "passengers" dropdown element
      var p = document.getElementById("passengers");
    
      // loop through the number of passengers selected
      for(var i=0; i < p.value; i++){
        // create a new div element
        var passengerDiv = document.createElement("div");
    
        // create the form fields and append them to the div element
        var fNameLabel = document.createElement("label");
        fNameLabel.setAttribute("for", "f_name"+i);
        fNameLabel.innerText = "First Name";
        passengerDiv.appendChild(fNameLabel);
    
        var fNameInput = document.createElement("input");
        fNameInput.setAttribute("type", "text");
        fNameInput.setAttribute("name", "f_name"+i);
        fNameInput.setAttribute("id", "f_name"+i);
        fNameInput.setAttribute("required", "required");
        fNameInput.style.display = "block";
        passengerDiv.appendChild(fNameInput);
  
        
        var lNameLabel = document.createElement("label");
        lNameLabel.setAttribute("for", "l_name"+i);
        lNameLabel.innerText = "Last Name";
        passengerDiv.appendChild(lNameLabel);
    
        var lNameInput = document.createElement("input");
        lNameInput.setAttribute("type", "text");
        lNameInput.setAttribute("name", "l_name"+i);
        lNameInput.setAttribute("id", "l_name"+i);
        lNameInput.setAttribute("required", "required");
        lNameInput.style.display = "block";
        passengerDiv.appendChild(lNameInput);
          
  
        
        var PassnoLabel = document.createElement("label");
        PassnoLabel.setAttribute("for", "P_no"+i);
        PassnoLabel.innerText = "Passport number";
        passengerDiv.appendChild(PassnoLabel);
    
        var PassnoInput = document.createElement("input");
        PassnoInput.setAttribute("type", "text");
        PassnoInput.setAttribute("name", "P_no"+i);
        PassnoInput.setAttribute("id", "P_no"+i);
        PassnoInput.setAttribute("required", "required");
        PassnoInput.style.display = "block";
        passengerDiv.appendChild(PassnoInput);

        var PassDOBLabel = document.createElement("label");
        PassDOBLabel.setAttribute("for", "P_DOB"+i);
        PassDOBLabel.innerText = "Date of Birth";
        passengerDiv.appendChild(PassDOBLabel);
    
        var PassDOBInput = document.createElement("input");
        PassDOBInput.setAttribute("type", "date");
        PassDOBInput.setAttribute("name", "P_DOB"+i);
        PassDOBInput.setAttribute("id", "P_DOB"+i);
        PassDOBInput.setAttribute("required", "required");
        PassDOBInput.style.display = "block";
        passengerDiv.appendChild(PassDOBInput);
        
        

        // repeat the process for the other form fields (last name, passport number, DOB)
        // ...
    
        // get the footer element and its parent node
        var footer = document.getElementById("seat");
        var parent = footer.parentNode;

        // insert the div element before the footer
        parent.insertBefore(passengerDiv, footer);
    }
    }
    </script>
    <script type="text/javascript">
    function getpass() {
            var arrname = new Array();
            var arrpassno = new Array();
            var arrdob = new Array();
            var passcount = document.getElementById("passengers");
            for(var i=0; i < passcount.value;i++ ){ 
                var fname = document.getElementById("f_name"+i);
                var lname = document.getElementById("l_name"+i);
                var pass_no = document.getElementById("P_no"+i);
                var passdob = document.getElementById("P_DOB"+i);
    
                arrname.push('"'+fname.value+' '+lname.value+'"');
                arrpassno.push('"'+pass_no.value+'"');
                arrdob.push('"'+passdob.value+'"');
            }
            if (arrname.length > 0) {
                var lst1 = arrname.join(",");
                var lst2 = arrpassno.join(",");
                var lst3 = arrdob.join(",");                    
            }
            document.getElementById("Passport_name").value = '{'+lst1+'}';
            document.getElementById("Passno").value = '{'+lst2+'}';
            document.getElementById("passDOB").value = '{'+lst3+'}';
        }
    </script>

    <div id="seat">
        <input type="button" name="confirm" id="confirm" value="Confirm Details" onclick = "getpass()" />
        <br>
        <input type="list" name="Passport_name" id="Passport_name"   onclick = "getpass()" />
        <br>
        <input type="list" name="Passno" id="Passno"   onclick = "getpass()" />
        <br>
        <input type="list" name="passDOB" id="passDOB"   onclick = "getpass()" />
    </div>
    <%- include('seat') %>
    <label for="seatNo">Seat IDs</label>
    <input style="background-color: rgba(0, 0, 0, 0.114);" type="button" value="Confirm" onclick = "GetSelected()" required style="display: block"/>
    <input  name="seatNo" id="seatNo" type ="list" value="Confirm Seats" onclick = "GetSelected()" hidden/>
    <input type="text" style="background-color: rgba(0, 0, 0, 0.114);" id="sure" value="" onclick = "GetSelected()"/>
    <script type="text/javascript">
        function GetSelected() {
            //Create an Array.
            var selected = new Array();
    
            //Reference the Plane class
            var tblplane = document.getElementById("plane");
    
            //Reference all the CheckBoxes in plane.
            var chks = tblplane.getElementsByTagName("INPUT");
    
            // Loop and push the checked CheckBox value in Array.
            for (var i = 0; i < chks.length; i++) {
                if (chks[i].checked) {
                    selected.push('"'+chks[i].value+'"');
                }
            }
    
            //Display the selected CheckBox values.
            if (selected.length > 0) {
                var lst = selected.join(",");
            }
            document.getElementById("seatNo").value = '{'+lst+'}';
            document.getElementById("sure").value = 'Selected seat : '+selected;
        };
    </script>
        <button type="submit">Submit</button>
    
    </form>
</div>

</div>

<%- include("partials/footer") -%>